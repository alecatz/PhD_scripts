%!PS-Adobe-3.0 EPSF-3.0
%%Creator: PS_dot.c,v 1.38 2007/02/02 15:18:13 ivo Exp $, ViennaRNA-2.1.3
%%CreationDate: Mon Oct 28 17:49:41 2013
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 66 210 518 662
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: -d2 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  72 216 translate
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  72 6 mul size div dup scale
  size xmin sub xmax sub 2 div size ymin sub ymax sub 2 div
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
GGTAACAAGATCAACGCTGGGATTTATCTTCTGAACCCATCTGTTCTTGATAAGATTGAGCTAAGACCGACTTCAATCGAAAAAGAGACTTTCCCTAAGATTGCAGCAGCGCAAGGGCTCTATGCTATGGTGCTACCAGGGTTTTGGATGGACATTGGGCAACCCCGTGACTACATAACGGGTTTGAGACTCTACTTAGACTCCCTTAGGA\
) def
/coor [
[114.46342468 135.29090881]
[121.63880920 150.03697205]
[112.23310852 163.47068787]
[95.92211914 161.77262878]
[89.48516846 146.68959045]
[99.54405975 133.73773193]
[92.87162781 130.31300354]
[86.02219391 143.65786743]
[79.17275238 157.00271606]
[72.32331085 170.34757996]
[65.47387695 183.69242859]
[58.62422943 197.03718567]
[45.27958679 190.18733215]
[52.12901688 176.84300232]
[58.97845840 163.49813843]
[65.82789612 150.15328979]
[72.67733765 136.80842590]
[79.52677155 123.46356964]
[72.85434723 120.03884888]
[61.63802719 129.99848938]
[60.54690170 145.53704834]
[49.03008652 155.47775269]
[34.22315598 154.34178162]
[23.00683975 164.30140686]
[24.65602303 179.73059082]
[16.89202499 193.16561890]
[2.70025897 199.44044495]
[-12.46224976 196.14227295]
[-22.76520729 184.53930664]
[-24.24691582 169.09313965]
[-16.33762932 155.74311829]
[-2.07862854 149.62261963]
[13.04720879 153.08509827]
[24.26352501 143.12545776]
[24.88677788 128.28810120]
[36.11983871 118.02783966]
[51.67839813 118.78216553]
[62.89471436 108.82253265]
[64.35286713 95.62029266]
[70.08454132 84.50408936]
[78.84854889 76.70345306]
[89.11330414 72.86062622]
[99.30295563 72.99204254]
[108.03104401 76.54440308]
[116.95537567 64.48802185]
[125.87969971 52.43164062]
[134.80403137 40.37525558]
[127.21266937 32.01916504]
[121.11342621 22.52387810]
[116.67388153 12.15277100]
[114.01557922 1.19324481]
[113.21075439 -10.05123615]
[114.28031921 -21.26954651]
[117.19335175 -32.15150833]
[121.86796570 -42.39646912]
[128.17364502 -51.72160721]
[135.93484497 -59.86973572]
[144.93591309 -66.61640167]
[154.92706299 -71.77607727]
[165.63131714 -75.20722198]
[176.75218201 -76.81622314]
[187.98185730 -76.55991364]
[199.00973511 -74.44671631]
[209.53106689 -70.53640747]
[217.34957886 -83.33761597]
[225.16809082 -96.13881683]
[232.98661804 -108.94001770]
[240.80513000 -121.74121857]
[224.56222534 -130.31510925]
[216.09701538 -145.82884216]
[217.56065369 -162.74488831]
[227.70375061 -175.48608398]
[242.54240417 -180.27444458]
[245.41423035 -194.99696350]
[240.46217346 -210.02320862]
[250.49305725 -221.03369141]
[253.36488342 -235.75621033]
[256.23672485 -250.47872925]
[251.28466797 -265.50497437]
[261.31555176 -276.51544189]
[264.18737793 -291.23797607]
[267.05920410 -305.96047974]
[269.93103027 -320.68301392]
[257.47808838 -332.56710815]
[257.99618530 -352.94561768]
[250.75430298 -366.08163452]
[243.51242065 -379.21765137]
[230.57041931 -390.16943359]
[237.51147461 -405.63739014]
[254.29643250 -403.24954224]
[256.64843750 -386.45953369]
[263.89031982 -373.32351685]
[271.13220215 -360.18750000]
[286.07296753 -361.51943970]
[290.87701416 -375.72933960]
[280.98419189 -364.45404053]
[268.46447754 -356.19223022]
[254.20719910 -351.53073120]
[239.22497559 -350.80062866]
[224.58200073 -354.05377197]
[211.31831360 -361.05911255]
[200.37603760 -371.31906128]
[192.53237915 -384.10488892]
[188.34446716 -398.50839233]
[188.10975647 -413.50656128]
[191.84490967 -428.03405762]
[199.28463745 -441.05905151]
[209.90051270 -451.65637207]
[222.93849182 -459.07333374]
[237.47251892 -462.78308105]
[252.47024536 -462.52215576]
[266.86642456 -458.30905151]
[279.63848877 -450.44305420]
[289.87930298 -439.48284912]
[296.86141968 -426.20693970]
[300.08895874 -411.55828857]
[299.33312988 -396.57983398]
[305.78411865 -410.12182617]
[301.79809570 -425.66180420]
[311.57714844 -438.37991333]
[327.61956787 -438.51986694]
[337.61904907 -425.97433472]
[333.90478516 -410.36715698]
[319.32608032 -403.67083740]
[312.87509155 -390.12887573]
[318.96875000 -385.75653076]
[332.63549805 -391.93872070]
[331.15603638 -377.01184082]
[337.24969482 -372.63949585]
[348.01229858 -383.08773804]
[349.68679810 -399.04318237]
[363.28231812 -407.56030273]
[378.36956787 -402.10549927]
[383.37487793 -386.86325073]
[374.45861816 -373.52609253]
[358.46057129 -372.32513428]
[347.69796753 -361.87689209]
[322.00817871 -359.11666870]
[305.08691406 -370.92529297]
[300.28286743 -356.71539307]
[303.42199707 -330.18206787]
[284.65356445 -317.81118774]
[281.78173828 -303.08865356]
[278.90988159 -288.36614990]
[276.03805542 -273.64361572]
[281.19552612 -259.67044067]
[270.95922852 -247.60690308]
[268.08740234 -232.88438416]
[265.21557617 -218.16184998]
[270.37304688 -204.18867493]
[260.13674927 -192.12513733]
[257.26492310 -177.40261841]
[264.70483398 -173.40029907]
[270.78512573 -167.01310730]
[274.73913574 -158.71809387]
[275.97146606 -149.23771667]
[274.13580322 -139.47753906]
[289.12097168 -138.81091309]
[303.41604614 -146.84724426]
[317.38339233 -138.25389099]
[316.65457153 -121.87094879]
[301.97937012 -114.55178833]
[288.45434570 -123.82572937]
[273.46917725 -124.49235535]
[286.30029297 -116.72305298]
[301.12283325 -114.42240143]
[314.20721436 -107.08766937]
[323.90414429 -95.64345551]
[328.99118042 -81.53238678]
[328.82705688 -66.53328705]
[323.43252563 -52.53689957]
[313.48754883 -41.30757523]
[300.24581909 -34.26086044]
[285.37652588 -32.28504944]
[270.75405884 -35.62920380]
[258.22167969 -43.87177277]
[249.35923767 -55.97370911]
[245.28387451 -70.40947723]
[246.50932312 -85.35933685]
[252.88215637 -98.94019318]
[253.60633850 -113.92270660]
[245.78781128 -101.12149811]
[237.96929932 -88.32029724]
[230.15078735 -75.51909637]
[222.33226013 -62.71789169]
[238.82807922 -44.13356400]
[247.47843933 -20.83849525]
[247.11021423 4.00810337]
[237.77334595 27.03660393]
[220.73405457 45.12394333]
[228.16979980 58.15121460]
[243.47932434 62.07472992]
[251.45843506 75.71691132]
[247.37329102 90.98410034]
[233.64750671 98.81854248]
[218.42436218 94.57219696]
[210.73547363 80.76435089]
[215.14253235 65.58695221]
[207.70678711 52.55968475]
[201.15994263 55.03881454]
[194.38691711 56.82775116]
[187.46029663 57.90629959]
[180.45443726 58.26187515]
[173.44465637 57.88965988]
[166.50637817 56.79267502]
[159.71441650 54.98173141]
[153.14208984 52.47535706]
[146.86041260 49.29958344]
[137.93608093 61.35596466]
[129.01176453 73.41234589]
[120.08743286 85.46873474]
] def
/pairs [
[1 6]
[19 38]
[20 37]
[23 34]
[24 33]
[44 211]
[45 210]
[46 209]
[47 208]
[64 185]
[65 184]
[66 183]
[67 182]
[68 181]
[73 152]
[74 151]
[76 149]
[77 148]
[78 147]
[80 145]
[81 144]
[82 143]
[83 142]
[85 93]
[86 92]
[87 91]
[94 140]
[95 139]
[117 125]
[118 124]
[129 137]
[130 136]
[157 164]
[158 163]
[190 199]
[191 198]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF

%!PS-Adobe-3.0 EPSF-3.0
%%Creator: PS_dot.c,v 1.38 2007/02/02 15:18:13 ivo Exp $, ViennaRNA-2.1.3
%%CreationDate: Mon Oct 28 17:49:41 2013
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 66 210 518 662
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: -d2 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  72 216 translate
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  72 6 mul size div dup scale
  size xmin sub xmax sub 2 div size ymin sub ymax sub 2 div
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
CCAGTGGGCCACACATAGTTGGGAATGTTCTTGTTGACGAAACCGCTACAATTGGGGAAGGATGTTTGATTGGACCAGACGTTGCCATTGGTCCAGGCTGCATTGTTGAGTCAGGAGTCAGACTCTCCCGATGCACGGTCATGCGTGGAGTCCGCATCAAGAAGCATGCGTGTATCTCGAGCAGTATCATCGGGTGGCACTCAACGGTTGGTCAATGGGCCAGGATCGAGAACATGACGATCCTCGG\
) def
/coor [
[89.42974854 577.84783936]
[89.42974854 562.84783936]
[82.23497772 561.14099121]
[75.38948059 558.32971191]
[69.06179047 554.48132324]
[63.40798569 549.68865967]
[58.56784058 544.06774902]
[54.66139984 537.75531006]
[51.78598022 530.90509033]
[50.01374435 523.68438721]
[49.38990021 516.26977539]
[49.93154526 508.84286499]
[51.62720108 501.58593750]
[54.43706131 494.67727661]
[58.29390717 488.28698730]
[63.10472870 482.57263184]
[68.75296021 477.67553711]
[75.10131073 473.71704102]
[70.42992401 459.46301270]
[65.75854492 445.20895386]
[61.08715820 430.95489502]
[56.41577530 416.70083618]
[51.65996552 416.62802124]
[46.97542191 415.80453491]
[42.47987747 414.25112915]
[38.28631210 412.00677490]
[27.28438187 422.20272827]
[16.28245163 432.39868164]
[5.28052092 442.59463501]
[4.93058062 458.39505005]
[-6.54703951 469.25967407]
[-22.34287071 468.74270630]
[-33.08552551 457.15084839]
[-32.40158081 441.36135864]
[-20.69680405 430.74188232]
[-4.91543531 431.59271240]
[6.08649540 421.39675903]
[17.08842659 411.20080566]
[28.09035683 401.00485229]
[24.95125389 392.80572510]
[24.31045532 384.00463867]
[26.24842644 375.34967041]
[30.62531662 367.58401489]
[37.09074402 361.38214111]
[45.11171341 357.29122925]
[44.16226959 342.32128906]
[43.21282578 327.35137939]
[42.26338196 312.38146973]
[33.74949265 307.61584473]
[28.14699364 299.62777710]
[13.15782452 300.19766235]
[-1.83134472 300.76757812]
[-12.54250336 312.07727051]
[-27.75177193 312.44171143]
[-38.46781158 302.16055298]
[-45.56528854 315.78118896]
[-58.53080368 324.01470947]
[-73.87670135 324.64636230]
[-87.47501373 317.50622559]
[-95.66786194 304.51495361]
[-96.25140381 289.16714478]
[-89.06867981 275.59127808]
[-76.05180359 267.43920898]
[-60.70224380 266.90377808]
[-47.14896393 274.12902832]
[-39.03772354 287.17138672]
[-29.13329887 276.10620117]
[-13.94026852 275.31472778]
[-2.40125465 285.77841187]
[12.58791447 285.20849609]
[27.57708359 284.63858032]
[30.18407822 278.66879272]
[34.48117828 273.65136719]
[40.13411713 270.05889893]
[46.67842865 268.25006104]
[50.43821716 253.72889709]
[49.07555008 246.48353577]
[54.33869553 239.04820251]
[58.28212738 224.57583618]
[62.22555923 210.10346985]
[66.16899109 195.63111877]
[58.57629776 182.86840820]
[62.36933136 168.13519287]
[75.80751038 160.25781250]
[79.75093842 145.78544617]
[71.11016846 140.88655090]
[63.60665131 134.37812805]
[57.53576279 126.51641846]
[53.13648605 117.61087799]
[50.58200455 108.01208496]
[49.97286987 98.09789276]
[51.33306122 88.25858307]
[54.60903549 78.88146973]
[59.67183304 70.33569336]
[66.32215881 62.95766068]
[74.29821777 57.03780365]
[83.28603363 52.80916214]
[78.60266876 44.99564362]
[80.51156616 37.87467575]
[77.86527252 23.10995102]
[75.21897125 8.34522533]
[72.57267761 -6.41950035]
[56.85309601 -10.66209030]
[44.60509491 -21.30155182]
[38.25130081 -36.16609192]
[39.01903152 -52.25509644]
[46.70356369 -66.34483337]
[59.71936798 -75.63436890]
[56.88625336 -90.36438751]
[54.05313873 -105.09440613]
[39.28515244 -108.95048523]
[27.65830421 -118.83882141]
[21.48111534 -132.79608154]
[21.98007011 -148.05104065]
[29.05610085 -161.57481384]
[41.30425644 -170.68225098]
[56.29265976 -173.56506348]
[71.04534912 -169.65086365]
[82.63316345 -159.71681213]
[88.75534058 -145.73533630]
[88.19631958 -130.48246765]
[81.06708527 -116.98665619]
[68.78315735 -107.92752075]
[71.61627197 -93.19750214]
[74.44938660 -78.46748352]
[88.00719452 -75.58584595]
[99.48141479 -67.73333740]
[107.12388611 -56.06638718]
[109.75505829 -42.32552719]
[106.94595337 -28.57575417]
[99.08768463 -16.89621353]
[87.33740234 -9.06579685]
[89.98369598 5.69892836]
[92.62999725 20.46365356]
[95.27629089 35.22837830]
[98.01605225 49.97604752]
[116.49208832 52.73116302]
[132.67195129 62.06748199]
[134.02288818 46.54933929]
[145.70439148 36.80270767]
[160.49024963 38.18625259]
[171.87161255 28.41566467]
[183.25299072 18.64507866]
[194.63436890 8.87449074]
[206.01573181 -0.89609665]
[211.44686890 -15.75588894]
[226.14364624 -18.17534447]
[227.15982056 -35.65080643]
[240.25051880 -46.75641251]
[256.98541260 -44.98177338]
[268.24209595 -54.89574814]
[264.07342529 -69.57855225]
[266.69665527 -84.61455536]
[275.59097290 -97.01834869]
[288.99038696 -104.32713318]
[304.23443604 -105.08976746]
[318.29641724 -99.15481567]
[328.38427734 -87.70066833]
[332.49511719 -73.00155640]
[329.81268311 -57.97599792]
[320.86959839 -45.60733414]
[307.44149780 -38.35136795]
[292.19458008 -37.64877319]
[278.15606689 -43.63905716]
[266.89938354 -33.72508240]
[267.89324951 -20.89236259]
[261.22131348 -9.65871525]
[249.12255859 -4.23205519]
[235.91423035 -6.79397202]
[231.29718018 7.36696196]
[215.78631592 10.48527527]
[204.40495300 20.25586319]
[193.02357483 30.02644920]
[181.64221191 39.79703522]
[170.26083374 49.56762314]
[169.38943481 64.39247894]
[157.98629761 74.46337128]
[142.44253540 73.44885254]
[149.21110535 90.80223083]
[149.16735840 109.42885590]
[142.31733704 126.75023651]
[129.60929871 140.36857605]
[112.80242157 148.39865112]
[94.22330475 149.72888184]
[90.27987671 164.20124817]
[97.86435699 177.80688477]
[93.65898895 192.42774963]
[80.64135742 199.57453918]
[76.69792175 214.04690552]
[72.75449371 228.51927185]
[68.81106567 242.99163818]
[64.95937347 257.48867798]
[61.19958878 272.00985718]
[70.90693665 293.26989746]
[57.23330307 311.43200684]
[58.18274689 326.40194702]
[59.13219070 341.37185669]
[60.08163452 356.34176636]
[79.89856720 369.66586304]
[84.17443085 392.91693115]
[70.66983795 412.02944946]
[75.34121704 426.28350830]
[80.01260376 440.53756714]
[84.68398285 454.79162598]
[89.35536957 469.04568481]
[113.73342133 471.61926270]
[133.57104492 485.91629028]
[143.67291260 508.11804199]
[141.43038940 532.34558105]
[127.49485779 552.21643066]
[135.26742554 565.04553223]
[143.04000854 577.87469482]
[162.79592896 581.65338135]
[173.20881653 598.50317383]
[167.91812134 617.27313232]
[176.17250061 629.79766846]
[184.42689514 642.32226562]
[199.65002441 645.62292480]
[207.84272766 658.44219971]
[204.60224915 672.93475342]
[220.02705383 672.65429688]
[233.14285278 680.77709961]
[239.76443481 694.71112061]
[237.77888489 710.01019287]
[227.81976318 721.79235840]
[213.06501770 726.29797363]
[198.22280884 722.08935547]
[188.02925110 710.50946045]
[185.73706055 695.25329590]
[192.07766724 681.18914795]
[177.48170471 678.45178223]
[168.93215942 665.86767578]
[171.90232849 650.57666016]
[163.64793396 638.05206299]
[155.39353943 625.52746582]
[145.19544983 626.24627686]
[135.53912354 622.65075684]
[128.18035889 615.32348633]
[124.48652649 605.53179932]
[125.18280792 595.00897217]
[130.21084595 585.64727783]
[122.43827820 572.81811523]
[114.66570282 559.98895264]
[111.32867432 561.19787598]
[107.91024780 562.15258789]
[104.42974854 562.84783936]
[104.42974854 577.84783936]
] def
/pairs [
[1 247]
[2 246]
[18 205]
[19 204]
[20 203]
[21 202]
[22 201]
[26 39]
[27 38]
[28 37]
[29 36]
[45 198]
[46 197]
[47 196]
[48 195]
[50 71]
[51 70]
[52 69]
[55 66]
[75 193]
[76 192]
[78 191]
[79 190]
[80 189]
[81 188]
[84 185]
[85 184]
[97 136]
[99 135]
[100 134]
[101 133]
[102 132]
[108 125]
[109 124]
[110 123]
[138 178]
[141 175]
[142 174]
[143 173]
[144 172]
[145 171]
[147 169]
[150 165]
[151 164]
[210 243]
[211 242]
[212 241]
[215 235]
[216 234]
[217 233]
[220 230]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF

%!PS-Adobe-3.0 EPSF-3.0
%%Creator: PS_dot.c,v 1.38 2007/02/02 15:18:13 ivo Exp $, ViennaRNA-2.1.3
%%CreationDate: Mon Oct 28 18:20:13 2013
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 66 210 518 662
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: -d2 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  72 216 translate
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  72 6 mul size div dup scale
  size xmin sub xmax sub 2 div size ymin sub ymax sub 2 div
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
GTTGGTGATGAAGCACAATCCAAAAGAGGTATCCTCACATTGAAATACCCTATTGAGCATGGTGTTGTTAGCAACTGGGATGACATGGAGAAGATTTGGCATCACACTTTCTACAATGAGCTCCGTATTGCTCCTGAAGAGCACCCGGTTCTACTTACCGAGGCTCCTCTTAACCCAAAAGCCAACAGAGAGAAGATGACTCAGATCATGTTTGAGACCTTTAATTCTCCAGC\
) def
/coor [
[86.50054932 217.37730408]
[86.50054932 202.37730408]
[86.50054932 187.37730408]
[86.50054932 172.37730408]
[86.50054932 157.37730408]
[77.29853821 169.22311401]
[63.18519592 174.30381775]
[48.54429245 171.04130554]
[37.92346573 160.44894409]
[34.62166977 145.81684875]
[39.66448212 131.68992615]
[51.48554230 122.45615387]
[66.41309357 120.98365784]
[79.81046295 127.72980499]
[87.51559448 140.59661865]
[76.15153503 135.14537048]
[66.88760376 126.59915924]
[60.53959656 115.71059418]
[45.84273529 118.71098328]
[31.14587593 121.71136475]
[26.56806374 143.86065674]
[10.68749428 160.85464478]
[-12.33732891 167.26657104]
[-35.95130920 160.57867432]
[-46.34217453 171.39671326]
[-45.77338028 187.19076538]
[-56.60027695 198.70396423]
[-72.39945984 199.10574341]
[-83.79754639 188.15773010]
[-84.03226471 172.35517883]
[-72.96435547 161.07347107]
[-57.16020966 161.00584412]
[-46.76934433 150.18780518]
[-53.74019241 136.90597534]
[-68.54594421 139.31213379]
[-83.35169983 141.71830750]
[-98.15745544 144.12448120]
[-112.96321106 146.53063965]
[-116.51049042 161.28504944]
[-125.41239166 173.52430725]
[-138.28721619 181.40164185]
[-153.15679932 183.74325562]
[-167.75039673 180.22306824]
[-179.85148621 171.40779114]
[-187.63436890 158.66589355]
[-202.44012451 161.07206726]
[-206.72145081 175.72242737]
[-216.94172668 187.05859375]
[-231.07170105 192.82977295]
[-246.30586243 191.89009094]
[-259.61944580 184.42613220]
[-268.36907959 171.91984558]
[-270.81744385 156.85438538]
[-266.47845459 142.22099304]
[-256.21362305 130.92515564]
[-242.06103516 125.20965576]
[-226.83068848 126.20932770]
[-213.54658508 133.72566223]
[-204.84629822 146.26631165]
[-190.04054260 143.86013794]
[-186.69314575 129.30938721]
[-178.00633240 117.11575317]
[-165.27850342 109.15541077]
[-150.43264771 106.66779327]
[-135.72590637 110.06269073]
[-123.40634918 118.85311127]
[-115.36937714 131.72489929]
[-100.56362152 129.31872559]
[-85.75786591 126.91255188]
[-70.95211792 124.50638580]
[-56.14636230 122.10021973]
[-54.20351028 110.83766174]
[-49.57577515 100.50569153]
[-42.60023880 91.72634888]
[-33.75341415 85.01358795]
[-23.61892700 80.74327850]
[-12.84917355 79.13241577]
[-2.12335181 80.22863770]
[7.89535093 83.91053009]
[16.60076714 89.89847565]
[23.48039818 97.77519989]
[28.14549065 107.01450348]
[42.84235001 104.01412201]
[57.53921127 101.01373291]
[60.66584778 83.97592926]
[70.33520508 69.60351562]
[84.93890381 60.28715897]
[102.04782104 57.57650757]
[118.81610870 61.92244339]
[132.45458984 72.60208130]
[145.44497681 65.10208130]
[158.43534851 57.60208130]
[171.42573547 50.10208130]
[200.74928284 25.42642784]
[212.36834717 15.93974686]
[223.98742676 6.45306635]
[235.60650635 -3.03361416]
[247.22557068 -12.52029514]
[247.02618408 -25.97826385]
[254.50080872 -36.93677521]
[266.73904419 -41.52613831]
[279.19973755 -38.28244781]
[290.94512939 -47.61228561]
[302.69052124 -56.94212341]
[300.54147339 -72.08573151]
[306.22344971 -86.17871094]
[318.11758423 -95.47365570]
[332.96789551 -97.55319214]
[346.77221680 -91.95800018]
[358.51760864 -101.28784180]
[370.26300049 -110.61767578]
[382.00836182 -119.94750977]
[372.58438110 -137.26133728]
[366.69735718 -156.06979370]
[364.56912231 -175.65861511]
[366.27890015 -195.28419495]
[371.76016235 -214.20187378]
[380.80334473 -231.69413757]
[393.06378174 -247.09786987]
[408.07495117 -259.82952881]
[425.26608276 -269.40710449]
[443.98400879 -275.46859741]
[463.51782227 -277.78543091]
[483.12600708 -276.27136230]
[502.06454468 -270.98541260]
[508.49490356 -284.53717041]
[498.27484131 -295.78967285]
[493.14358521 -310.09835815]
[493.88360596 -325.28125000]
[500.38204956 -339.02310181]
[511.64797974 -349.22836304]
[525.96337891 -354.34082031]
[541.14532471 -353.58081055]
[554.87860107 -347.06430054]
[565.06903076 -335.78494263]
[570.16265869 -321.46279907]
[569.38269043 -306.28189087]
[562.84808350 -292.55718994]
[551.55535889 -282.38159180]
[537.22656250 -277.30685425]
[522.04669189 -278.10678101]
[515.61627197 -264.55502319]
[523.38659668 -259.65124512]
[530.67864990 -254.06108093]
[537.43212891 -247.83087158]
[543.59094238 -241.01225281]
[549.10406494 -233.66174316]
[562.09442139 -241.16174316]
[575.08477783 -248.66174316]
[588.07519531 -256.16174316]
[587.39514160 -271.45211792]
[593.90936279 -285.30218506]
[606.12078857 -294.52926636]
[621.22338867 -297.01306152]
[635.74676514 -292.18280029]
[646.35345459 -281.14843750]
[650.60614014 -266.44561768]
[647.52758789 -251.45291138]
[637.82525635 -239.61553955]
[623.72863770 -233.65365601]
[608.47705078 -234.93725586]
[595.57519531 -243.17135620]
[582.58477783 -235.67135620]
[569.59442139 -228.17135620]
[556.60406494 -220.67135620]
[561.16046143 -209.61505127]
[564.37756348 -198.09611511]
[566.20983887 -186.27615356]
[566.63128662 -174.32107544]
[565.63555908 -162.39871216]
[563.23645020 -150.67645264]
[559.46722412 -139.31893921]
[554.38049316 -128.48573303]
[548.04748535 -118.32904053]
[540.55670166 -108.99164581]
[532.01306152 -100.60482788]
[522.53637695 -93.28657532]
[512.25946045 -87.13986969]
[501.32635498 -82.25129700]
[489.89050293 -78.68978882]
[478.11233521 -76.50563812]
[466.15710449 -75.72984314]
[454.19265747 -76.37361145]
[442.38702393 -78.42823792]
[430.90594482 -81.86519623]
[419.91070557 -86.63653564]
[409.55581665 -92.67557526]
[399.98681641 -99.89781952]
[391.33822632 -108.20212555]
[379.59283447 -98.87229156]
[367.84744263 -89.54244995]
[356.10205078 -80.21261597]
[358.42880249 -65.50031281]
[353.04315186 -51.50563049]
[341.29809570 -42.02301788]
[326.28500366 -39.67705917]
[312.02035522 -45.19673538]
[300.27496338 -35.86689758]
[288.52957153 -26.53706169]
[287.32492065 -9.75523949]
[274.09005737 1.17211187]
[256.71224976 -0.90122032]
[245.09318542 8.58546066]
[233.47410583 18.07214165]
[221.85502625 27.55882072]
[210.23596191 37.04550171]
[225.19342041 38.17431259]
[230.78733826 52.09222031]
[220.77149963 63.25836563]
[206.32887268 59.20367813]
[214.00259399 72.09220123]
[221.67631531 84.98072052]
[234.97454834 95.49705505]
[228.55052185 111.18679810]
[211.69558716 109.35717010]
[208.78779602 92.65444183]
[201.11407471 79.76592255]
[193.44035339 66.87739563]
[178.92573547 63.09246063]
[165.93534851 70.59246063]
[152.94497681 78.09246063]
[139.95458984 85.59246063]
[142.44529724 98.46910858]
[140.88870239 111.49172974]
[135.43327332 123.41857910]
[126.59915924 133.11239624]
[115.22874451 139.64884949]
[102.40622711 142.40467834]
[101.50054932 157.37730408]
[101.50054932 172.37730408]
[101.50054932 187.37730408]
[101.50054932 202.37730408]
[101.50054932 217.37730408]
] def
/pairs [
[1 233]
[2 232]
[3 231]
[4 230]
[5 229]
[15 228]
[18 84]
[19 83]
[20 82]
[24 33]
[25 32]
[34 71]
[35 70]
[36 69]
[37 68]
[38 67]
[45 60]
[46 59]
[90 222]
[91 221]
[92 220]
[93 219]
[94 206]
[95 205]
[96 204]
[97 203]
[98 202]
[102 199]
[103 198]
[104 197]
[109 192]
[110 191]
[111 190]
[112 189]
[125 142]
[126 141]
[147 165]
[148 164]
[149 163]
[150 162]
[210 218]
[211 217]
[212 216]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
